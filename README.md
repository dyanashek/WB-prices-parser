# WB prices parser
## Change language: [English](README.en.md)
***
Телеграмм бот для отслеживания реальных рекламных ставок WB в карточке и поиске. Реализована система подписки с автопродлением, бонусная система.
## [LIVE](https://t.me/WildBoost_bot)
## [DEMO](README.demo.md)
## Функционал:
1. Определяет ставки на рекламу WB в поиске
2. Определяет ставки на рекламу WB в карточке
3. Подключена бонусная система
4. Генерирует реферальный QR-code
5. Оплата подписки
6. Автоматическое продление подписки
7. Выгрузка данных из базы данных в google таблицы
## Команды:
**Для удобства рекомендуется добавить данные команды в боковое меню бота, используя [BotFather](https://t.me/BotFather).**
- referral - получить реферальную ссылку и qr-code
- profile - открыть профиль
- help - помощь

**Команды доступные менеджеру:**
- users - выгрузка информации о пользователях в google таблицу
- payments - выгрузка информации о платежах в google таблицу

## Установка и использование:
- Логирование при ошибке ведется в файл py_log.log
- Установить зависимости:
```sh
pip install -r requirements.txt
```
- в файле .env указать:
  - Токен телеграмм бота: **TELEGRAM_TOKEN**=ТОКЕН
  - ID бота: **BOT_ID**=ID (первые цифры из токена бота, до :)
  - ID менеджера: **MANAGER_ID**=MANAGER_ID; будет иметь право на выполнение команды /update, ему будут приходить уведомления - для получения уведомлений менеджеру необходимо активировать бота со своего аккаунта (нажать кнопку "начать")
  > Для определения ID пользователя нужно отправить следующему [боту](https://t.me/getmyid_bot) любое сообщение с соответствующего аккаунта. Значение, содержащееся в **Your user ID** - ID пользователя
  - Username менеджера - на указанный профиль введет кнопка "менеджер" в меню: **MANAGER_USERNAME**=example (указывается без @)
  - **ACCOUNT_ID** - номер магазина Yookassa
  - **SECRET_KEY** - секретный ключ Yookassa
  - **SPREAD_NAME** - имя таблицы в google sheets, куда записываются данные о новых заявках
  - **USERS_LIST_NAME** - имя листа в таблице, куда будут выгружаться данные о пользователях
  - **PAYMENTS_LIST_NAME** - имя листа в таблице, куда будут выгружаться данные о платежах
- получить файл c credentials (параметрами для подключения):\
https://console.cloud.google.com/ \
https://www.youtube.com/watch?v=bu5wXjz2KvU - инструкция с 00:00 по 02:35\
Полученный файл сохранить в корне проекта, с именем **service_account.json**
- предоставить сервисному e-mail доступ к таблице (инструкция в видео по ссылке выше)
- запустить проект:
```sh
python3 main.py
```
